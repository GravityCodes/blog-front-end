---
import Layout from "../layouts/Layout.astro";
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import "../styles/CredentialScreens.css"
---

<Layout>
  <Nav />

  <form method="POST">
    <h1>JohanCodes</h1>
    <h2>Login</h2>
    <div class="form-section">
      <label for="email">Email</label>
      <input type="text" id="email" name="email" required>
    </div>
    <!-- {errors.email && <p>{errors.email}</p>} -->
    <div class="form-section">
      <label for="password">Password</label>
      <input type="password" id="password" name="password" required>
    </div>
    <!-- {errors.password && <p>{errors.password}</p>} -->
    <button type="submit">Login</button>
  </form>
  <Footer />

</Layout>

<style>
  form {
    
  }
</style>

<script>
  const form = document.querySelector('form');

  form?.addEventListener('submit', async function (e) {
    e.preventDefault();

    const data = {
      email: this.email.value,
      password: this.password.value,
    };


    const response = await fetch(import.meta.env.PUBLIC_LOGIN_API, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      credentials: "include",
      body: JSON.stringify(data)
    });

    if(response.ok) {
      console.log(response);
      // window.location.href = "/";
    } else {
      console.error("Failed to submit JSON form");
    }

  });
</script>
